<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>3D Healthy Heart vs Heart Failure</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #0d1421;
      color: #e0f2ff;
      overflow: hidden;
    }
    #ui {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 10;
      background: rgba(15, 35, 65, 0.75);
      backdrop-filter: blur(8px);
      padding: 1.2rem 1.8rem;
      border-radius: 12px;
      border: 1px solid #456;
      max-width: 380px;
    }
    h1 {
      margin: 0 0 0.9rem;
      font-size: 1.6rem;
      color: #a0d8ff;
    }
    button {
      padding: 0.7rem 1.3rem;
      margin: 0 0.6rem 0.6rem 0;
      background: #2a5a8a;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: 0.22s;
    }
    button:hover { background: #3a7ac8; }
    button.active {
      background: #4fc3f7;
      color: #0d1b2a;
    }
    #info {
      font-size: 0.94rem;
      line-height: 1.45;
      margin-top: 1rem;
      opacity: 0.92;
    }
    #credits {
      position: absolute;
      bottom: 12px;
      left: 20px;
      font-size: 0.78rem;
      opacity: 0.7;
      z-index: 5;
    }
  </style>
</head>
<body>

<div id="ui">
  <h1>Heart 3D Comparison</h1>
  <button id="btn-healthy" class="active">Healthy</button>
  <button id="btn-failure">Heart Failure</button>

  <div id="info">
    <strong>Healthy heart</strong><br>
    • Normal size & shape<br>
    • Strong contraction<br>
    • Good ejection fraction (~60%)<br><br>

    <strong>Heart failure</strong> (dilated type)<br>
    • Enlarged chambers<br>
    • Thinner walls<br>
    • Weakened pumping
  </div>
</div>

<div id="credits">Procedural model • Three.js • GitHub Pages</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/controls/OrbitControls.min.js"></script>

<script>
// ────────────────────────────────────────────────
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x091220);

const camera = new THREE.PerspectiveCamera(52, innerWidth/innerHeight, 0.1, 50);
camera.position.set(0, 0.8, 4.2);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.085;
controls.minDistance = 1.6;
controls.maxDistance = 9;

// Lights
scene.add(new THREE.AmbientLight(0xffffff, 0.55));

const key = new THREE.DirectionalLight(0xfff9e8, 1.6);
key.position.set(6, 10, 7);
scene.add(key);

const rim = new THREE.DirectionalLight(0xaaccff, 0.9);
rim.position.set(-5, 6, -8);
scene.add(rim);

// ─── Heart factory ───────────────────────────────
function createHeart(options = {}) {
  const {
    scale         = 1,
    color         = 0xe63946,
    emissive      = 0x3a0f18,
    dilation      = 1,      // 1 = normal, >1 = enlarged
    wallThickness = 1,      // relative
  } = options;

  const group = new THREE.Group();

  const mat = new THREE.MeshStandardMaterial({
    color,
    emissive,
    emissiveIntensity: 0.28,
    metalness: 0.12,
    roughness: 0.68,
  });

  // Main ventricular mass
  const main = new THREE.Mesh(
    new THREE.SphereGeometry(1, 36, 28),
    mat
  );
  main.scale.set(1.18 * dilation, 1.42 * dilation, 1.05 * dilation);
  group.add(main);

  // Left ventricle emphasis
  const lv = new THREE.Mesh(
    new THREE.SphereGeometry(0.95, 32, 24),
    mat
  );
  lv.position.set(0.4 * dilation, 0.05, -0.1);
  lv.scale.set(1.15 * dilation, 1.38 * dilation, 1.0);
  group.add(lv);

  // Atria (simplified)
  const atria = new THREE.Mesh(
    new THREE.SphereGeometry(0.72, 28, 20),
    mat
  );
  atria.position.y = 1.15 * dilation;
  atria.scale.set(1.55, 0.7 * wallThickness, 1.25);
  group.add(atria);

  // Slight realistic tilt
  group.rotation.z = -0.28;
  group.rotation.y = 0.42;

  group.userData.baseScale = scale;

  return group;
}

// ─── Models ─────────────────────────────────────
const healthy = createHeart({
  scale: 1,
  color: 0xed254e,
  emissive: 0x3f0915
});
healthy.visible = true;
scene.add(healthy);

const failure = createHeart({
  scale: 1,
  color: 0xd00000,
  emissive: 0x55000a,
  dilation: 1.38,         // visibly enlarged
  wallThickness: 0.78     // slightly thinner feel
});
failure.visible = false;
scene.add(failure);

// ─── Gentle beating animation ───────────────────
let t = 0;
const freqHealthy = 5.1;
const ampHealthy  = 0.045;
const freqFail    = 4.4;     // slightly slower & irregular
  </html>
